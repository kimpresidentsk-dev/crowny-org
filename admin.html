<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CROWNY ADMIN</title>
    <!-- Lucide Icons (ì„ í˜• ì•„ì´ì½˜) -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- CSS Modules -->
<link rel="stylesheet" href="css/base.css?v=1.1">
<link rel="stylesheet" href="css/components.css?v=1.1">
<link rel="stylesheet" href="css/dark.css?v=1.1">
<link rel="stylesheet" href="css/mobile.css?v=1.1">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-auth-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-firestore-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-storage-compat.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAqrMOtOCVTMqzsVEJgAMq5SBrpUzgABS8",
            authDomain: "crowny-84b84.firebaseapp.com",
            projectId: "crowny-84b84",
            storageBucket: "crowny-84b84.firebasestorage.app",
            messagingSenderId: "482020243607",
            appId: "1:482020243607:web:8b60558c7af507f4bed1d2"
        };
        firebase.initializeApp(firebaseConfig);
        window.auth = firebase.auth();
        window.db = firebase.firestore();
        window.OFFCHAIN_RATE = 100;
        window.OFFCHAIN_TOKENS = {
            CRTD: { name: 'í¬ë¼ìš°ë‹ˆ íŠ¸ë ˆì´ë”© ë‹¬ëŸ¬', icon: 'trending-up', color: '#FF6D00' },
            CRAC: { name: 'í¬ë¼ìš°ë‹ˆ ì•„íŠ¸ í¬ë ˆë”§', icon: 'palette', color: '#E91E63' },
            CRGC: { name: 'í¬ë¼ìš°ë‹ˆ êµ¿ì¦ˆ & ê¸°ë¹™', icon: 'shopping-bag', color: '#00BFA5' },
            CREB: { name: 'í¬ë¼ìš°ë‹ˆ ì—ì½” ë°”ì´ì˜¤', icon: 'leaf', color: '#2E7D32' }
        };
        window.THIRDWEB_CONFIG = { clientId: '26c044bdfa2f575538d00945419126bf', contracts: { CRNY: '0xe56173b6a57680286253566B9C80Fcc175c88bE1', FNC: '0x68E3aA1049F583C2f1701fefc4443e398ebF32ee', CRFN: '0x396DAd0C7625a4881cA0cd444Cd80A9bbce4A054' } };
    </script>
    <style>
        .admin-layout { display:flex; min-height:100vh; }
        .admin-sidebar { width:220px; background:var(--bg-card); color:var(--text); padding:1rem 0; position:fixed; height:100vh; overflow-y:auto; border-right:1px solid var(--border); }
        .admin-sidebar .logo { padding:1rem 1.5rem; border-bottom:1px solid var(--border); margin-bottom:1rem; }
        .admin-sidebar .logo h1 { font-size:1.2rem; letter-spacing:2px; color:var(--accent); }
        .admin-sidebar .logo p { font-size:0.75rem; color:var(--text-secondary); }
        .admin-sidebar .nav-link { display:block; padding:0.7rem 1.5rem; color:var(--text-secondary); text-decoration:none; font-size:0.85rem; transition:all 0.2s; }
        .admin-sidebar .nav-link:hover { background:rgba(139,105,20,0.1); color:var(--text); }
        .admin-sidebar .nav-link.active { background:rgba(139,105,20,0.15); color:var(--accent); border-left:3px solid var(--accent); }
        .admin-main { margin-left:220px; padding:1.5rem; flex:1; background:var(--bg); min-height:100vh; }
        @media(max-width:768px) {
            .admin-sidebar { width:100%; height:auto; position:relative; }
            .admin-main { margin-left:0; }
            .admin-layout { flex-direction:column; }
        }
    </style>
</head>
<body>
    <div class="admin-layout">
        <aside class="admin-sidebar">
            <div class="logo">
                <h1>ğŸ” CROWNY</h1>
                <p>ADMIN PANEL</p>
            </div>
            <a href="index.html" class="nav-link">â† ë©”ì¸ìœ¼ë¡œ</a>
            <div id="admin-sidebar-nav"></div>
            <div style="padding:1rem 1.5rem; border-top:1px solid rgba(255,255,255,0.1); margin-top:1rem;">
                <p id="admin-user-email" style="font-size:0.75rem; color:rgba(255,255,255,0.5);"></p>
                <button onclick="auth.signOut();location.href='index.html'" style="margin-top:0.5rem;background:rgba(255,255,255,0.1);color:white;border:none;padding:0.4rem 0.8rem;border-radius:6px;cursor:pointer;font-size:0.8rem;width:100%;">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </aside>
        <main class="admin-main">
            <div id="admin-loading" style="text-align:center;padding:3rem;color:var(--accent);">ë¡œë”© ì¤‘...</div>
            <div id="admin-content" style="display:none;">
<div id="admin-not-authorized" style="text-align:center; padding:2rem; color:var(--accent);">
                ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.
            </div>
            
            <div id="admin-panel" style="display:none;">
                <!-- ê´€ë¦¬ì ë ˆë²¨ í‘œì‹œ -->
                <div id="admin-level-badge" style="text-align:center; padding:0.8rem; background:#1a1a2e; color:white; border-radius:8px; margin-bottom:1rem; font-size:0.9rem;"></div>
                
                <!-- â˜… ê´€ë¦¬ì íƒ­ ë©”ë‰´ -->
                <div id="admin-tab-bar" style="display:flex; gap:4px; overflow-x:auto; padding:4px; background:#f0f0f0; border-radius:10px; margin-bottom:1rem;">
                    <!-- JSì—ì„œ ê¶Œí•œë³„ íƒ­ ë™ì  ìƒì„± -->
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- TAB 1: ğŸ”¥ ì˜¤í”„ì²´ì¸ í¬ì¸íŠ¸ ê´€ë¦¬ (ë ˆë²¨ 2+)   -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div id="admin-tab-offchain" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸ”¥ ì˜¤í”„ì²´ì¸ í¬ì¸íŠ¸ ê´€ë¦¬</h3>
                        <p style="font-size:0.75rem; color:var(--accent); margin-bottom:1rem;">Firebase DB Â· Zero-Gas Â· 100 pt = 1 CRNY</p>
                        
                        <!-- ìœ ì € ì”ì•¡ ì¡°íšŒ -->
                        <div style="background:#e3f2fd; padding:1rem; border-radius:8px; margin-bottom:1rem;">
                            <h4 style="font-size:0.85rem; margin-bottom:0.5rem;">ğŸ” ìœ ì € ì˜¤í”„ì²´ì¸ ì”ì•¡ ì¡°íšŒ</h4>
                            <div style="display:flex; gap:0.5rem; align-items:end;">
                                <input type="email" id="admin-off-lookup-email" placeholder="user@email.com" style="flex:1; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                <button onclick="adminLookupOffchain()" style="background:#1565c0; color:white; border:none; padding:0.5rem 1rem; border-radius:4px; cursor:pointer; white-space:nowrap;">ì¡°íšŒ</button>
                            </div>
                            <div id="admin-off-lookup-result" style="margin-top:0.5rem; font-size:0.85rem;"></div>
                        </div>
                        
                        <!-- í¬ì¸íŠ¸ ë°œí–‰ (ë¯¼íŒ…) â€” ìˆ˜í¼ê´€ë¦¬ì ì „ìš© -->
                        <div id="admin-mint-section" style="background:#e8f5e9; padding:1rem; border-radius:8px; margin-bottom:1rem;">
                            <h4 style="font-size:0.85rem; margin-bottom:0.5rem;">ğŸ“ˆ í¬ì¸íŠ¸ ë°œí–‰ (ë¯¼íŒ…)</h4>
                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr auto; gap:0.5rem; align-items:end;">
                                <div>
                                    <label style="font-size:0.7rem;">ì´ë©”ì¼</label>
                                    <input type="email" id="admin-off-mint-email" placeholder="user@email.com" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                </div>
                                <div>
                                    <label style="font-size:0.7rem;">í† í°</label>
                                    <select id="admin-off-mint-token" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                        <option value="crtd">ğŸ“ˆ CRTD</option>
                                        <option value="crac">ğŸ­ CRAC</option>
                                        <option value="crgc">ğŸ›’ CRGC</option>
                                        <option value="creb">ğŸŒ± CREB</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size:0.7rem;">ìˆ˜ëŸ‰</label>
                                    <input type="number" id="admin-off-mint-amount" value="100" min="1" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                </div>
                                <button onclick="adminMintOffchain()" style="background:#2e7d32; color:white; border:none; padding:0.5rem 1rem; border-radius:4px; cursor:pointer;">ë°œí–‰</button>
                            </div>
                            <div>
                                <label style="font-size:0.7rem;">ì‚¬ìœ </label>
                                <input type="text" id="admin-off-mint-reason" placeholder="ì´ë²¤íŠ¸ ë³´ìƒ, í”„ë¡œëª¨ì…˜ ë“±" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px; margin-top:0.3rem; box-sizing:border-box;">
                            </div>
                        </div>
                        
                        <!-- í¬ì¸íŠ¸ ì°¨ê° (ì†Œê°) â€” ìˆ˜í¼ê´€ë¦¬ì ì „ìš© -->
                        <div id="admin-burn-section" style="background:#fce4ec; padding:1rem; border-radius:8px; margin-bottom:1rem;">
                            <h4 style="font-size:0.85rem; margin-bottom:0.5rem;">ğŸ“‰ í¬ì¸íŠ¸ ì°¨ê° (ì†Œê°)</h4>
                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr auto; gap:0.5rem; align-items:end;">
                                <div>
                                    <label style="font-size:0.7rem;">ì´ë©”ì¼</label>
                                    <input type="email" id="admin-off-burn-email" placeholder="user@email.com" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                </div>
                                <div>
                                    <label style="font-size:0.7rem;">í† í°</label>
                                    <select id="admin-off-burn-token" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                        <option value="crtd">ğŸ“ˆ CRTD</option>
                                        <option value="crac">ğŸ­ CRAC</option>
                                        <option value="crgc">ğŸ›’ CRGC</option>
                                        <option value="creb">ğŸŒ± CREB</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size:0.7rem;">ìˆ˜ëŸ‰</label>
                                    <input type="number" id="admin-off-burn-amount" value="100" min="1" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                </div>
                                <button onclick="adminBurnOffchain()" style="background:#c62828; color:white; border:none; padding:0.5rem 1rem; border-radius:4px; cursor:pointer;">ì°¨ê°</button>
                            </div>
                            <div>
                                <label style="font-size:0.7rem;">ì‚¬ìœ </label>
                                <input type="text" id="admin-off-burn-reason" placeholder="íŒ¨ë„í‹°, í™˜ë¶ˆ ë“±" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px; margin-top:0.3rem; box-sizing:border-box;">
                            </div>
                        </div>

                        <!-- â˜… í† í° ê´€ë¦¬ (ìˆ˜í¼ê´€ë¦¬ì ì „ìš©) -->
                        <div id="admin-token-mgmt-section" style="background:linear-gradient(135deg,#fff8e1,#fff3e0); padding:1rem; border-radius:8px; margin-bottom:1rem; border:1px solid #ffcc80;">
                            <h4 style="font-size:0.85rem; margin-bottom:0.6rem;">ğŸª™ ì˜¤í”„ì²´ì¸ í† í° ê´€ë¦¬</h4>
                            
                            <!-- ë“±ë¡ëœ í† í° ëª©ë¡ -->
                            <div id="admin-token-list" style="margin-bottom:0.8rem;"></div>
                            
                            <!-- ìƒˆ í† í° ìƒì„± -->
                            <details style="margin-top:0.5rem;">
                                <summary style="cursor:pointer; font-size:0.82rem; font-weight:600; color:#E65100;">â• ìƒˆ í† í° ìƒì„±</summary>
                                <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:0.4rem; margin-top:0.5rem;">
                                    <div>
                                        <label style="font-size:0.68rem;">KEY (ì˜ë¬¸ì†Œë¬¸ì)</label>
                                        <input type="text" id="new-token-key" placeholder="ì˜ˆ: crpt" maxlength="10" style="width:100%; padding:0.4rem; border:1px solid var(--border); border-radius:4px; font-size:0.82rem;">
                                    </div>
                                    <div>
                                        <label style="font-size:0.68rem;">ì´ë¦„ (ëŒ€ë¬¸ì)</label>
                                        <input type="text" id="new-token-name" placeholder="ì˜ˆ: CRPT" maxlength="10" style="width:100%; padding:0.4rem; border:1px solid var(--border); border-radius:4px; font-size:0.82rem;">
                                    </div>
                                    <div>
                                        <label style="font-size:0.68rem;">ì„¤ëª…</label>
                                        <input type="text" id="new-token-fullname" placeholder="ì˜ˆ: í”„ë¼ì´ë¹— í† í°" style="width:100%; padding:0.4rem; border:1px solid var(--border); border-radius:4px; font-size:0.82rem;">
                                    </div>
                                </div>
                                <div style="display:grid; grid-template-columns:auto 1fr auto; gap:0.4rem; margin-top:0.4rem; align-items:end;">
                                    <div>
                                        <label style="font-size:0.68rem;">ì•„ì´ì½˜</label>
                                        <input type="text" id="new-token-icon" value="ğŸª™" maxlength="2" style="width:40px; padding:0.4rem; border:1px solid var(--border); border-radius:4px; text-align:center; font-size:1.1rem;">
                                    </div>
                                    <div>
                                        <label style="font-size:0.68rem;">ìƒ‰ìƒ</label>
                                        <input type="color" id="new-token-color" value="#FF6D00" style="width:100%; height:32px; border:1px solid var(--border); border-radius:4px; cursor:pointer;">
                                    </div>
                                    <button onclick="createCustomToken()" style="background:#E65100; color:white; border:none; padding:0.5rem 1rem; border-radius:4px; cursor:pointer; font-weight:600; font-size:0.82rem;">ğŸª™ ìƒì„±</button>
                                </div>
                            </details>
                        </div>
                        
                        <!-- â˜… ì¼ê´„ ë°°í¬ (ìˆ˜í¼ê´€ë¦¬ì ì „ìš©) -->
                        <div id="admin-dist-section" style="background:linear-gradient(135deg,#e8eaf6,#e3f2fd); padding:1rem; border-radius:8px; margin-bottom:1rem; border:1px solid #90caf9;">
                            <h4 style="font-size:0.85rem; margin-bottom:0.6rem;">ğŸ“¦ í† í° ì¼ê´„ ë°°í¬</h4>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.4rem;">
                                <div>
                                    <label style="font-size:0.7rem;">í† í°</label>
                                    <select id="admin-dist-token" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                        <option value="crtd">ğŸ“ˆ CRTD</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size:0.7rem;">1ì¸ë‹¹ ìˆ˜ëŸ‰</label>
                                    <input type="number" id="admin-dist-amount" value="100" min="1" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                </div>
                            </div>
                            <div style="margin-top:0.4rem;">
                                <label style="font-size:0.7rem;">ì‚¬ìœ </label>
                                <input type="text" id="admin-dist-reason" placeholder="ì´ë²¤íŠ¸ ë³´ìƒ, í”„ë¡œëª¨ì…˜ ë“±" style="width:100%; padding:0.4rem; border:1px solid var(--border); border-radius:4px; box-sizing:border-box;">
                            </div>
                            <div style="margin-top:0.4rem;">
                                <label style="font-size:0.7rem;">ëŒ€ìƒ ì´ë©”ì¼ (ì¤„ë°”ê¿ˆ/ì‰¼í‘œ êµ¬ë¶„)</label>
                                <textarea id="admin-dist-emails" rows="4" placeholder="user1@email.com&#10;user2@email.com&#10;user3@email.com" style="width:100%; padding:0.4rem; border:1px solid var(--border); border-radius:4px; font-size:0.8rem; resize:vertical; box-sizing:border-box;"></textarea>
                            </div>
                            <div style="display:flex; gap:0.4rem; margin-top:0.5rem;">
                                <button onclick="adminBatchDistribute()" style="flex:1; background:#1565C0; color:white; border:none; padding:0.5rem; border-radius:4px; cursor:pointer; font-weight:600; font-size:0.82rem;">ğŸ“¦ ì„ íƒ ë°°í¬</button>
                                <button onclick="adminDistributeToAll()" style="flex:0.6; background:#7B1FA2; color:white; border:none; padding:0.5rem; border-radius:4px; cursor:pointer; font-weight:600; font-size:0.82rem;">ğŸŒ ì „ì²´ ë°°í¬</button>
                            </div>
                            <div id="admin-dist-result" style="margin-top:0.5rem;"></div>
                        </div>

                        <!-- ìµœê·¼ ì˜¤í”„ì²´ì¸ ê±°ë˜ ë‚´ì—­ -->
                        <div style="background:var(--bg); padding:1rem; border-radius:8px;">
                            <h4 style="font-size:0.85rem; margin-bottom:0.5rem;">ğŸ“œ ìµœê·¼ ì˜¤í”„ì²´ì¸ ê±°ë˜ ë‚´ì—­</h4>
                            <button onclick="adminLoadOffchainTxLog()" style="background:#455a64; color:white; border:none; padding:0.4rem 0.8rem; border-radius:4px; cursor:pointer; font-size:0.8rem; margin-bottom:0.5rem;">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                            <div id="admin-off-tx-log" style="max-height:300px; overflow-y:auto;"></div>
                        </div>
                    </div>
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- TAB 2: ğŸ’° ì˜¨ì²´ì¸ ì§€ê°‘ (ë ˆë²¨ 4+)           -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div id="admin-tab-wallet" class="admin-tab-content" style="display:none;">
                    <!-- ì‚­ì œëœ ì§€ê°‘ ì¡°íšŒ -->
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
                            <h3 style="margin:0;">ğŸ—‘ï¸ ì‚­ì œëœ ì§€ê°‘</h3>
                            <button onclick="adminLoadDeletedWallets()" style="background:#c62828;color:white;border:none;padding:0.4rem 0.8rem;border-radius:6px;cursor:pointer;font-size:0.8rem;">ğŸ” ì¡°íšŒ</button>
                        </div>
                        <div id="admin-deleted-wallets"><p style="font-size:0.85rem;color:#999;">ì¡°íšŒ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</p></div>
                    </div>
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸ’° ì˜¨ì²´ì¸ ì§€ê°‘ ê´€ë¦¬</h3>
                        <div id="admin-wallet-info" style="margin-bottom:1rem;">
                            <button onclick="loadAdminWallet()" class="btn-primary" style="margin-bottom:0.5rem;">ğŸ”„ ì§€ê°‘ ìƒˆë¡œê³ ì¹¨</button>
                        </div>
                        <div style="background:var(--bg); padding:1rem; border-radius:8px; margin-bottom:1rem;">
                            <h4 style="font-size:0.85rem; margin-bottom:0.5rem;">ğŸ“¤ í† í° ë³´ë‚´ê¸° (ì˜¨ì²´ì¸ Polygon)</h4>
                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr auto; gap:0.5rem; align-items:end;">
                                <div>
                                    <label style="font-size:0.75rem;">ë°›ëŠ” ì‚¬ëŒ ì´ë©”ì¼</label>
                                    <input type="email" id="admin-send-email" placeholder="user@email.com" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                </div>
                                <div>
                                    <label style="font-size:0.75rem;">í† í°</label>
                                    <select id="admin-send-token" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                        <option value="crny">CRNY</option>
                                        <option value="fnc">FNC</option>
                                        <option value="crfn">CRFN</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size:0.75rem;">ìˆ˜ëŸ‰</label>
                                    <input type="number" id="admin-send-amount" value="1" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                </div>
                                <button onclick="adminSendToken()" style="background:#0066cc; color:white; border:none; padding:0.5rem 1rem; border-radius:4px; cursor:pointer; white-space:nowrap;">ë³´ë‚´ê¸°</button>
                            </div>
                            <p style="font-size:0.7rem; color:var(--accent); margin-top:0.5rem;">âš ï¸ Polygon ì˜¨ì²´ì¸ ì „ì†¡ â€” POL(MATIC) ê°€ìŠ¤ë¹„ í•„ìš”</p>
                        </div>
                    </div>
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- TAB 3: ğŸ“Š ì±Œë¦°ì§€ ê´€ë¦¬ (ë ˆë²¨ 3+)           -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div id="admin-tab-challenge" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸ“Š ì±Œë¦°ì§€ ì°¸ê°€ì ê´€ë¦¬</h3>
                        <button onclick="loadAdminParticipants()" class="btn-primary" style="margin-bottom:1rem;">ğŸ”„ ì°¸ê°€ì ëª©ë¡ ìƒˆë¡œê³ ì¹¨</button>
                        <div id="admin-participants-list"></div>
                    </div>
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- TAB 4: ğŸ‘¥ íšŒì› ê´€ë¦¬ (ë ˆë²¨ 6)              -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div id="admin-tab-users" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸ‘¥ ê´€ë¦¬ì ê³„ì¸µ ê´€ë¦¬</h3>
                        <!-- ê¶Œí•œ ë§¤íŠ¸ë¦­ìŠ¤ -->
                        <div style="background:#f3e5f5; padding:1rem; border-radius:8px; margin-bottom:1rem;">
                            <h4 style="font-size:0.85rem; margin-bottom:0.5rem;">ğŸ“‹ ê³„ì¸µ ê¶Œí•œí‘œ</h4>
                            <div style="font-size:0.75rem; line-height:1.8;">
                                <div>ğŸ‘‘ <strong>Lv6 ìˆ˜í¼</strong>: í† í° ë°œí–‰/ì°¨ê° + ì¿¼í„° ì„¤ì • + Lv5 ì„ëª…</div>
                                <div>ğŸŒ <strong>Lv5 êµ­ê°€</strong>: ì˜¨Â·ì˜¤í”„ì²´ì¸ + ì±Œë¦°ì§€ + Lv4 ì„ëª…</div>
                                <div>ğŸ’¼ <strong>Lv4 ì‚¬ì—…</strong>: ì˜¨Â·ì˜¤í”„ì²´ì¸ + ì±Œë¦°ì§€ + Lv3 ì„ëª…</div>
                                <div>ğŸ”§ <strong>Lv3 ì„œë¹„ìŠ¤</strong>: ì˜¤í”„ì²´ì¸(ì¡°íšŒ) + ì±Œë¦°ì§€ + Lv2 ì„ëª…</div>
                                <div>ğŸ“ <strong>Lv2 ìš´ì˜</strong>: ì˜¤í”„ì²´ì¸(ì¡°íšŒ) ì „ìš©</div>
                                <div>ğŸ’¬ <strong>Lv1 CS</strong>: ì½ê¸° ì „ìš©</div>
                            </div>
                        </div>
                        <button onclick="loadAdminUserList()" class="btn-primary" style="margin-bottom:0.5rem;">ğŸ”„ ê´€ë¦¬ì í˜„í™©</button>
                        <div id="admin-user-list"></div>
                    </div>
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- TAB 5: ğŸ ê¸°ë¶€í’€ ê´€ë¦¬ (ë ˆë²¨ 3+)           -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div id="admin-tab-giving" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸ ê¸°ë¶€í’€ ê´€ë¦¬ (CRGC)</h3>
                        <button onclick="adminLoadGivingPool()" class="btn-primary" style="margin-bottom:1rem;">ğŸ”„ ê¸°ë¶€í’€ í˜„í™©</button>
                        <div id="admin-giving-pool-info" style="background:#e8f5e9; padding:1rem; border-radius:8px; margin-bottom:1rem;"></div>
                        <div>
                            <h4 style="font-size:0.85rem; margin-bottom:0.5rem;">ğŸ¯ ê¸°ë¶€í’€ ë¶„ë°°</h4>
                            <div style="display:flex; gap:0.5rem; align-items:end;">
                                <div style="flex:1;">
                                    <label style="font-size:0.7rem;">ë°›ëŠ” ì‚¬ëŒ ì´ë©”ì¼</label>
                                    <input type="email" id="admin-giving-email" placeholder="user@email.com" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                </div>
                                <div>
                                    <label style="font-size:0.7rem;">ìˆ˜ëŸ‰ (CRGC pt)</label>
                                    <input type="number" id="admin-giving-amount" value="100" min="1" style="width:100%; padding:0.5rem; border:1px solid var(--border); border-radius:4px;">
                                </div>
                                <button onclick="adminDistributeGivingPool()" style="background:#00897b; color:white; border:none; padding:0.5rem 1rem; border-radius:4px; cursor:pointer;">ë¶„ë°°</button>
                            </div>
                        </div>
                        <div style="margin-top:1rem;">
                            <h4 style="font-size:0.85rem; margin-bottom:0.5rem;">ğŸ“œ ê¸°ë¶€í’€ ë¡œê·¸</h4>
                            <div id="admin-giving-log" style="max-height:250px; overflow-y:auto;"></div>
                        </div>
                    </div>
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- TAB: â­ ì†Œê°œì ë³´ìƒ ì„¤ì • (ìˆ˜í¼ê´€ë¦¬ì)      -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div id="admin-tab-referral" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">â­ ì†Œê°œì ë³´ìƒ ì„¤ì •</h3>
                        <p style="font-size:0.85rem; color:var(--accent); margin-bottom:1rem;">íšŒì›ê°€ì… ì‹œ ì†Œê°œìì—ê²Œ ì§€ê¸‰ë˜ëŠ” ì˜¤í”„ì²´ì¸ í† í° ìˆ˜ì¹˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</p>
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.8rem; margin-bottom:1rem;">
                            <div>
                                <label style="font-size:0.8rem; font-weight:600;">ğŸ“ˆ CRTD</label>
                                <input type="number" id="referral-cfg-crtd" value="30" min="0" max="10000" style="width:100%; padding:0.5rem; border:1px solid #ddd; border-radius:6px;">
                            </div>
                            <div>
                                <label style="font-size:0.8rem; font-weight:600;">ğŸ­ CRAC</label>
                                <input type="number" id="referral-cfg-crac" value="20" min="0" max="10000" style="width:100%; padding:0.5rem; border:1px solid #ddd; border-radius:6px;">
                            </div>
                            <div>
                                <label style="font-size:0.8rem; font-weight:600;">ğŸ›’ CRGC</label>
                                <input type="number" id="referral-cfg-crgc" value="30" min="0" max="10000" style="width:100%; padding:0.5rem; border:1px solid #ddd; border-radius:6px;">
                            </div>
                            <div>
                                <label style="font-size:0.8rem; font-weight:600;">ğŸŒ± CREB</label>
                                <input type="number" id="referral-cfg-creb" value="20" min="0" max="10000" style="width:100%; padding:0.5rem; border:1px solid #ddd; border-radius:6px;">
                            </div>
                        </div>
                        <button onclick="saveReferralRewardConfig()" class="btn-primary" style="width:100%; padding:0.7rem;">ğŸ’¾ ë³´ìƒ ìˆ˜ì¹˜ ì €ì¥</button>
                    </div>
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- TAB 6.5: âš–ï¸ ë¹„ìœ¨ ê´€ë¦¬ (ìˆ˜í¼ê´€ë¦¬ì)         -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div id="admin-tab-rate" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">âš–ï¸ ì˜¤í”„ì²´ì¸/CRNY êµí™˜ ë¹„ìœ¨</h3>
                        <p style="font-size:0.85rem; color:#666; margin-bottom:1rem;">
                            í† í°ë³„ë¡œ ê°œë³„ ë¹„ìœ¨ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                            ë³€ê²½ ì‹œ 2ë‹¨ê³„ í™•ì¸ì´ í•„ìš”í•˜ë©°, ëª¨ë“  ë³€ê²½ì€ ë¡œê·¸ì— ê¸°ë¡ë©ë‹ˆë‹¤.
                        </p>
                        
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.8rem; margin-bottom:1.5rem;">
                            <div style="background:linear-gradient(135deg,#fff3e0,#ffe0b2); padding:1rem; border-radius:10px; border:1px solid #ffcc80;">
                                <div style="display:flex; align-items:center; gap:0.5rem; margin-bottom:0.5rem;">
                                    <span style="font-size:1.2rem;">ğŸ“ˆ</span>
                                    <strong style="font-size:0.9rem;">CRTD</strong>
                                    <span style="font-size:0.7rem; color:#e65100;">íŠ¸ë ˆì´ë”©</span>
                                </div>
                                <div style="display:flex; gap:0.4rem; align-items:center;">
                                    <input type="number" id="rate-crtd" value="100" min="1" max="10000" style="flex:1; padding:0.6rem; border:1px solid #ffcc80; border-radius:6px; font-size:1rem; font-weight:700; box-sizing:border-box;">
                                    <span style="font-size:0.75rem; color:#666;">pt/CRNY</span>
                                </div>
                            </div>
                            <div style="background:linear-gradient(135deg,#fce4ec,#f8bbd0); padding:1rem; border-radius:10px; border:1px solid #f48fb1;">
                                <div style="display:flex; align-items:center; gap:0.5rem; margin-bottom:0.5rem;">
                                    <span style="font-size:1.2rem;">ğŸ­</span>
                                    <strong style="font-size:0.9rem;">CRAC</strong>
                                    <span style="font-size:0.7rem; color:#c2185b;">ì—”í„°í…Œì¸ë¨¼íŠ¸</span>
                                </div>
                                <div style="display:flex; gap:0.4rem; align-items:center;">
                                    <input type="number" id="rate-crac" value="100" min="1" max="10000" style="flex:1; padding:0.6rem; border:1px solid #f48fb1; border-radius:6px; font-size:1rem; font-weight:700; box-sizing:border-box;">
                                    <span style="font-size:0.75rem; color:#666;">pt/CRNY</span>
                                </div>
                            </div>
                            <div style="background:linear-gradient(135deg,#e0f2f1,#b2dfdb); padding:1rem; border-radius:10px; border:1px solid #80cbc4;">
                                <div style="display:flex; align-items:center; gap:0.5rem; margin-bottom:0.5rem;">
                                    <span style="font-size:1.2rem;">ğŸ›’</span>
                                    <strong style="font-size:0.9rem;">CRGC</strong>
                                    <span style="font-size:0.7rem; color:#00695c;">ì»¤ë¨¸ìŠ¤</span>
                                </div>
                                <div style="display:flex; gap:0.4rem; align-items:center;">
                                    <input type="number" id="rate-crgc" value="100" min="1" max="10000" style="flex:1; padding:0.6rem; border:1px solid #80cbc4; border-radius:6px; font-size:1rem; font-weight:700; box-sizing:border-box;">
                                    <span style="font-size:0.75rem; color:#666;">pt/CRNY</span>
                                </div>
                            </div>
                            <div style="background:linear-gradient(135deg,#e8f5e9,#c8e6c9); padding:1rem; border-radius:10px; border:1px solid #81c784;">
                                <div style="display:flex; align-items:center; gap:0.5rem; margin-bottom:0.5rem;">
                                    <span style="font-size:1.2rem;">ğŸŒ±</span>
                                    <strong style="font-size:0.9rem;">CREB</strong>
                                    <span style="font-size:0.7rem; color:#2e7d32;">ì—ì½”Â·ë°”ì´ì˜¤</span>
                                </div>
                                <div style="display:flex; gap:0.4rem; align-items:center;">
                                    <input type="number" id="rate-creb" value="100" min="1" max="10000" style="flex:1; padding:0.6rem; border:1px solid #81c784; border-radius:6px; font-size:1rem; font-weight:700; box-sizing:border-box;">
                                    <span style="font-size:0.75rem; color:#666;">pt/CRNY</span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom:1rem;">
                            <label style="font-size:0.8rem; color:#666; display:block; margin-bottom:0.3rem;">ğŸ“ ë³€ê²½ ì‚¬ìœ  (í•„ìˆ˜)</label>
                            <input type="text" id="rate-change-reason" placeholder="ë¹„ìœ¨ ë³€ê²½ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”" style="width:100%; padding:0.7rem; border:1px solid #ddd; border-radius:8px; font-size:0.9rem; box-sizing:border-box;">
                        </div>
                        
                        <button onclick="requestRateChange()" style="width:100%; background:#ff5722; color:white; border:none; padding:0.9rem; border-radius:8px; cursor:pointer; font-weight:700; font-size:1rem;">âš–ï¸ ë¹„ìœ¨ ë³€ê²½</button>
                        
                        <h4 style="margin:1.5rem 0 0.8rem;">ğŸ“œ ë³€ê²½ ì´ë ¥</h4>
                        <div id="admin-rate-history" style="max-height:300px; overflow-y:auto;">
                            ë³€ê²½ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤
                        </div>
                    </div>
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- TAB 6: ğŸ“‹ ê´€ë¦¬ì ë¡œê·¸ (ë ˆë²¨ 3+)           -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div id="admin-tab-log" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸ“‹ ê´€ë¦¬ì í™œë™ ë¡œê·¸</h3>
                        <button onclick="loadAdminLog()" class="btn-primary" style="margin-bottom:1rem;">ğŸ”„ ë¡œê·¸ ìƒˆë¡œê³ ì¹¨</button>
                        <div id="admin-log-list"></div>
                    </div>
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- TAB: ğŸ“ˆ ëŒ€ì‹œë³´ë“œ í†µê³„ (ë ˆë²¨ 3+)           -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div id="admin-tab-dashboard" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                            <h3 style="margin:0;">ğŸ“ˆ ëŒ€ì‹œë³´ë“œ í†µê³„</h3>
                            <div style="display:flex; gap:0.5rem; align-items:center;">
                                <span id="dashboard-cache-info" style="font-size:0.7rem; color:#999;"></span>
                                <button onclick="loadAdminDashboardStats(true)" style="background:#1565c0; color:white; border:none; padding:0.4rem 0.8rem; border-radius:6px; cursor:pointer; font-size:0.8rem;">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                            </div>
                        </div>

                        <!-- ì‚¬ìš©ì í†µê³„ -->
                        <div style="margin-bottom:1.5rem;">
                            <h4 style="font-size:0.9rem; margin-bottom:0.6rem;">ğŸ‘¥ ì‚¬ìš©ì í†µê³„</h4>
                            <div id="dash-user-stats" style="display:grid; grid-template-columns:repeat(auto-fit, minmax(140px, 1fr)); gap:0.6rem;">
                                <div style="background:#e3f2fd; padding:1rem; border-radius:10px; text-align:center;">
                                    <div style="font-size:0.75rem; color:#1565c0;">ì´ ì‚¬ìš©ì</div>
                                    <div id="dash-total-users" style="font-size:1.8rem; font-weight:800; color:#0d47a1;">-</div>
                                </div>
                                <div style="background:#e8f5e9; padding:1rem; border-radius:10px; text-align:center;">
                                    <div style="font-size:0.75rem; color:#2e7d32;">ì˜¤ëŠ˜ ê°€ì…</div>
                                    <div id="dash-today-users" style="font-size:1.8rem; font-weight:800; color:#1b5e20;">-</div>
                                </div>
                                <div style="background:#fff3e0; padding:1rem; border-radius:10px; text-align:center;">
                                    <div style="font-size:0.75rem; color:#e65100;">ì´ë²ˆ ì£¼ ê°€ì…</div>
                                    <div id="dash-week-users" style="font-size:1.8rem; font-weight:800; color:#bf360c;">-</div>
                                </div>
                            </div>
                        </div>

                        <!-- ê±°ë˜ í†µê³„ -->
                        <div style="margin-bottom:1.5rem;">
                            <h4 style="font-size:0.9rem; margin-bottom:0.6rem;">ğŸ’° ê±°ë˜ í†µê³„</h4>
                            <div id="dash-tx-stats" style="display:grid; grid-template-columns:repeat(auto-fit, minmax(140px, 1fr)); gap:0.6rem;">
                                <div style="background:#f3e5f5; padding:1rem; border-radius:10px; text-align:center;">
                                    <div style="font-size:0.75rem; color:#7b1fa2;">ì´ ê±°ë˜</div>
                                    <div id="dash-total-tx" style="font-size:1.8rem; font-weight:800; color:#4a148c;">-</div>
                                </div>
                                <div style="background:#fce4ec; padding:1rem; border-radius:10px; text-align:center;">
                                    <div style="font-size:0.75rem; color:#c2185b;">ì˜¤ëŠ˜ ê±°ë˜</div>
                                    <div id="dash-today-tx" style="font-size:1.8rem; font-weight:800; color:#880e4f;">-</div>
                                </div>
                            </div>
                            <div id="dash-tx-by-token" style="margin-top:0.6rem; display:grid; grid-template-columns:repeat(auto-fit, minmax(120px, 1fr)); gap:0.4rem;"></div>
                        </div>

                        <!-- ì„¹ì…˜ë³„ í†µê³„ -->
                        <div style="margin-bottom:1.5rem;">
                            <h4 style="font-size:0.9rem; margin-bottom:0.6rem;">ğŸ“Š ì„¹ì…˜ë³„ í†µê³„</h4>
                            <div id="dash-section-stats" style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:0.8rem;"></div>
                        </div>

                        <!-- ì°¨íŠ¸: ìµœê·¼ 7ì¼ ê°€ì…ì -->
                        <div style="margin-bottom:1.5rem;">
                            <h4 style="font-size:0.9rem; margin-bottom:0.6rem;">ğŸ“… ìµœê·¼ 7ì¼ ê°€ì…ì</h4>
                            <div id="dash-chart-signups" style="display:flex; align-items:flex-end; gap:4px; height:150px; padding:0.5rem; background:#f9f9f9; border-radius:10px;"></div>
                        </div>

                        <!-- ì°¨íŠ¸: í† í°ë³„ ê±°ë˜ëŸ‰ -->
                        <div>
                            <h4 style="font-size:0.9rem; margin-bottom:0.6rem;">ğŸª™ í† í°ë³„ ê±°ë˜ëŸ‰</h4>
                            <div id="dash-chart-tokens" style="display:flex; align-items:flex-end; gap:8px; height:150px; padding:0.5rem; background:#f9f9f9; border-radius:10px;"></div>
                        </div>
                    </div>
                </div>

                <!-- ğŸ¦ ìŠˆí¼ê´€ë¦¬ì ê³„ì¢Œ ê´€ë¦¬ íƒ­ -->
                <div id="admin-tab-superwall" class="admin-tab-content" style="display:none;">
                    <!-- Content rendered dynamically by loadSuperAdminWallets() -->
                </div>

                <!-- ìƒí’ˆ ìŠ¹ì¸/ì‹ ê³  ê´€ë¦¬ íƒ­ -->
                <div id="admin-tab-products" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸ“¦ ìƒí’ˆ ìŠ¹ì¸ ê´€ë¦¬</h3>
                        <div id="admin-pending-products">ë¡œë”©...</div>
                    </div>
                    <div style="background:white; padding:1.5rem; border-radius:12px;">
                        <h3 style="margin-bottom:1rem;">ğŸš¨ ì‹ ê³  ê´€ë¦¬</h3>
                        <div id="admin-reports-list">ë¡œë”©...</div>
                    </div>
                </div>

                <!-- ì¿ í° ê´€ë¦¬ íƒ­ -->
                <div id="admin-tab-coupon" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸŸï¸ ì¿ í° ê´€ë¦¬</h3>
                        <div style="display:grid; gap:0.8rem;">
                            <input type="text" id="coupon-name" placeholder="ì¿ í° ì´ë¦„ (ì˜ˆ: í¬ë¼ìš°ë‹ˆíŠ¸ë ˆì´ë”© ì±Œë¦°ì§€ ê¸°ë… ì¿ í° 2026)" style="padding:0.6rem; border:1px solid #ddd; border-radius:6px;">
                            <div style="display:flex; gap:0.5rem;">
                                <input type="text" id="coupon-code" placeholder="ì¿ í° ì½”ë“œ (ì˜ë¬¸/ìˆ«ì)" style="flex:1; padding:0.6rem; border:1px solid #ddd; border-radius:6px; text-transform:uppercase; font-family:monospace;">
                                <select id="coupon-token" style="padding:0.6rem; border:1px solid #ddd; border-radius:6px;">
                                    <option value="crtd">CRTD</option>
                                    <option value="crac">CRAC</option>
                                    <option value="crgc">CRGC</option>
                                    <option value="creb">CREB</option>
                                </select>
                            </div>
                            <div style="display:flex; gap:0.5rem;">
                                <input type="number" id="coupon-amount" placeholder="ì§€ê¸‰ ìˆ˜ëŸ‰" style="flex:1; padding:0.6rem; border:1px solid #ddd; border-radius:6px;">
                                <input type="number" id="coupon-max-uses" placeholder="ìµœëŒ€ ì‚¬ìš© (0=ë¬´ì œí•œ)" value="0" style="flex:1; padding:0.6rem; border:1px solid #ddd; border-radius:6px;">
                            </div>
                            <div style="display:flex; gap:0.5rem;">
                                <input type="datetime-local" id="coupon-expiry" style="flex:1; padding:0.6rem; border:1px solid #ddd; border-radius:6px;">
                                <input type="text" id="coupon-desc" placeholder="ì„¤ëª… (ì„ íƒ)" style="flex:1; padding:0.6rem; border:1px solid #ddd; border-radius:6px;">
                            </div>
                            <button onclick="createCoupon()" class="btn-primary">ğŸŸï¸ ì¿ í° ìƒì„±</button>
                        </div>
                    </div>
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸ“‹ ì¿ í° ëª©ë¡</h3>
                        <button onclick="loadCouponList()" class="btn-primary" style="margin-bottom:1rem;">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                        <div id="coupon-list"></div>
                    </div>
                    <div id="coupon-log-section" style="display:none; background:white; padding:1.5rem; border-radius:12px;">
                        <h3 style="margin-bottom:1rem;">ğŸ“œ ì¿ í° ì‚¬ìš© ë¡œê·¸</h3>
                        <div id="coupon-log-list"></div>
                        <button onclick="closeCouponLog()" class="btn-primary" style="margin-top:0.5rem; background:#999;">ë‹«ê¸°</button>
                    </div>
                </div>

                <!-- AI Settings Tab -->
                <div id="admin-tab-rewards" class="admin-tab-content" style="display:none;">
                    <!-- ë¦¬ì›Œë“œ ì„¤ì • â€” JSì—ì„œ ë™ì  ë Œë”ë§ (loadRewardSettingsTab) -->
                </div>

                <div id="admin-tab-ai" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px;">
                        <h3 style="margin-bottom:1rem;">ğŸ‘‘ í¬ë¼ìš°ë‹ˆ íŒ¨ë„ ì„¤ì •</h3>
                        <div style="display:grid; gap:1rem;">
                            <label style="display:flex; align-items:center; gap:0.5rem; font-weight:600;">
                                <input type="checkbox" id="ai-admin-toggle" checked> AI ë„ìš°ë¯¸ í™œì„±í™”
                            </label>
                            <div>
                                <label style="font-weight:600; display:block; margin-bottom:0.3rem;">Gemini API í‚¤</label>
                                <input type="password" id="ai-admin-apikey" placeholder="Google AI Studio API Key" style="width:100%; padding:0.6rem; border:1px solid #ddd; border-radius:6px; box-sizing:border-box; font-family:monospace;">
                                <small style="color:#888;">Google AI Studioì—ì„œ ë¬´ë£Œ API í‚¤ë¥¼ ë°œê¸‰ë°›ìœ¼ì„¸ìš”</small>
                            </div>
                            <div>
                                <label style="font-weight:600; display:block; margin-bottom:0.3rem;">ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸</label>
                                <textarea id="ai-admin-prompt" rows="8" style="width:100%; padding:0.6rem; border:1px solid #ddd; border-radius:6px; box-sizing:border-box; font-size:0.85rem; resize:vertical;"></textarea>
                            </div>
                            <button onclick="AI_ASSISTANT.saveAdminSettings()" class="btn-primary">ğŸ’¾ ì„¤ì • ì €ì¥</button>
                        </div>
                    </div>

                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-top:1rem;">
                        <h3 style="margin-bottom:1rem;">ğŸ¤– AI ì†Œì…œ ë´‡</h3>
                        <p style="font-size:0.85rem; color:#666; margin-bottom:1rem;">5ëª…ì˜ AI ìºë¦­í„°ê°€ ì†Œì…œ í”¼ë“œì— ìë™ìœ¼ë¡œ ê¸€ì„ ì˜¬ë¦¬ê³ , ëŒ“ê¸€ì— ë‹µë³€í•©ë‹ˆë‹¤.</p>
                        <div style="display:grid; gap:0.5rem;">
                            <button onclick="aiSocialPostAll()" class="btn-primary" style="background:linear-gradient(135deg,#D4AF37,#F0C060);color:#1a1a2e;">ğŸš€ ì „ì²´ ìºë¦­í„° í¬ìŠ¤íŒ… (5ëª…)</button>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem; margin-top:0.5rem;">
                                <button onclick="aiSocialPostOne('kps')" style="padding:0.5rem;border:1px solid #ddd;border-radius:8px;cursor:pointer;background:white;">ğŸ‘” KPS</button>
                                <button onclick="aiSocialPostOne('hansun')" style="padding:0.5rem;border:1px solid #ddd;border-radius:8px;cursor:pointer;background:white;">ğŸ¹ í•œì„ </button>
                                <button onclick="aiSocialPostOne('michael')" style="padding:0.5rem;border:1px solid #ddd;border-radius:8px;cursor:pointer;background:white;">ğŸ¤ ë§ˆì´í´</button>
                                <button onclick="aiSocialPostOne('matthew')" style="padding:0.5rem;border:1px solid #ddd;border-radius:8px;cursor:pointer;background:white;">ğŸ”§ ë§¤íŠœ</button>
                                <button onclick="aiSocialPostOne('crownygirl')" style="padding:0.5rem;border:1px solid #ddd;border-radius:8px;cursor:pointer;background:white;grid-column:span 2;">âœ¨ í¬ë¼ìš°ë‹ˆê±¸</button>
                            </div>
                            <div id="ai-social-result" style="margin-top:0.5rem;font-size:0.8rem;color:#666;"></div>
                        </div>
                    </div>

                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-top:1rem;">
                        <h3 style="margin-bottom:1rem;">âœ¨ ë·°í‹°ë§¤ë‹ˆì € â€” ë¶„ì„ ìš”ì²­</h3>
                        <p style="font-size:0.85rem; color:#666; margin-bottom:1rem;">ì‚¬ìš©ìë“¤ì˜ í”¼ë¶€ ë¶„ì„ ìš”ì²­ ëª©ë¡ì…ë‹ˆë‹¤. ì‚¬ì§„ì„ í™•ì¸í•˜ê³  ë¶„ì„ ê²°ê³¼ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
                        <button onclick="BEAUTY.loadAdminRequests()" style="padding:0.5rem 1rem;border:none;border-radius:6px;background:#E91E63;color:white;cursor:pointer;margin-bottom:0.5rem;">ğŸ”„ ìš”ì²­ ëª©ë¡ ìƒˆë¡œê³ ì¹¨</button>
                        <div id="beauty-admin-requests"><p style="color:#888;font-size:0.85rem;">ëª©ë¡ì„ ë¡œë“œí•˜ë ¤ë©´ ìœ„ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p></div>
                    </div>
                </div>

                <!-- TAB: ğŸ”§ ê¸°ëŠ¥ ê´€ë¦¬ (Features) -->
                <div id="admin-tab-features" class="admin-tab-content" style="display:none;">
                    <div style="background:white; padding:1.5rem; border-radius:12px;">
                        <h3 style="margin-bottom:1rem;">ğŸ”§ ê¸°ëŠ¥ ê´€ë¦¬ (Feature Flags)</h3>
                        <p style="color:#666; font-size:0.85rem; margin-bottom:1rem;">ì¼ë°˜ ìœ ì €ì—ê²Œ ë³´ì´ëŠ” ë©”ë‰´ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤. ìˆ˜í¼ê´€ë¦¬ìëŠ” í•­ìƒ ëª¨ë“  ë©”ë‰´ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                        
                        <!-- Seed Data Button -->
                        <div style="background:#fff3e0;border:1px solid #ffcc02;border-radius:8px;padding:1rem;margin-bottom:1rem;">
                            <p style="font-size:0.85rem;margin-bottom:0.5rem;"><strong>ğŸŒ± ì´ˆê¸° ë°ì´í„° ì‹œë“œ</strong></p>
                            <p style="font-size:0.75rem;color:#666;margin-bottom:0.8rem;">ì•„í‹°ìŠ¤íŠ¸, ì‚¬ì—…ì²´, ìº í˜ì¸, AI ë´‡ í”„ë¡œí•„ ë“± ì´ˆê¸° ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ë¯¸ ìˆëŠ” ë°ì´í„°ëŠ” ê±´ë“œë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                            <button onclick="seedAll().then(r=>document.getElementById('seed-result').textContent=r)" style="padding:0.6rem 1.2rem;background:#ff9800;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600;">ğŸŒ± ì‹œë“œ ë°ì´í„° ì‹¤í–‰</button>
                            <pre id="seed-result" style="margin-top:0.5rem;font-size:0.75rem;color:#333;white-space:pre-wrap;"></pre>
                        </div>
                        <div id="feature-flags-list" style="display:grid; gap:0.8rem;"></div>
                        <script>
                        (function(){
                            const features = [
                                { key: 'home', label: 'ğŸ  í™ˆ/íˆ¬ë°ì´', stable: true },
                                { key: 'wallet', label: 'ğŸ’° ì§€ê°‘', stable: true },
                                { key: 'social', label: 'ğŸ“¸ ì†Œì…œ', stable: true },
                                { key: 'messenger', label: 'ğŸ’¬ ë©”ì‹ ì €', stable: true },
                                { key: 'settings', label: 'âš™ï¸ ì„¤ì •', stable: true },
                                { key: 'trading', label: 'ğŸ“ˆ íŠ¸ë ˆì´ë”© ê²Œì„' },
                                { key: 'ai_assistant', label: 'ğŸ‘‘ í¬ë¼ìš°ë‹ˆ íŒ¨ë„' },
                                { key: 'beauty', label: 'âœ¨ ë·°í‹° ë§¤ë‹ˆì €' },
                                { key: 'brain', label: 'ğŸ§  ë¸Œë ˆì¸' },
                                { key: 'movement', label: 'ğŸ’ª ë¬´ë¸Œë¨¼íŠ¸' },
                                { key: 'care', label: 'ğŸ’ í¬ë¼ìš°ë‹ˆì¼€ì–´' },
                                { key: 'reels', label: 'ğŸ¬ ë¦´ìŠ¤' },
                                { key: 'art', label: 'ğŸ¨ ì•„íŠ¸' },
                                { key: 'books', label: 'ğŸ“š ë„ì„œ' },
                                { key: 'mall', label: 'ğŸ›’ ì‡¼í•‘ëª°' },
                                { key: 'energy', label: 'ğŸ”¬ CREB Labs' },
                                { key: 'business', label: 'ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤' },
                                { key: 'artist', label: 'ğŸŒŸ ì•„í‹°ìŠ¤íŠ¸' },
                            ];
                            
                            function renderFlags() {
                                const flags = typeof getFeatureFlags === 'function' ? getFeatureFlags() : {};
                                const container = document.getElementById('feature-flags-list');
                                container.innerHTML = '';
                                features.forEach(f => {
                                    const enabled = f.stable || flags[f.key] || false;
                                    const div = document.createElement('div');
                                    div.style.cssText = 'display:flex;align-items:center;justify-content:space-between;padding:0.8rem;background:#f8f9fa;border-radius:8px;border:1px solid #e0e0e0;';
                                    div.innerHTML = `
                                        <span style="font-size:0.9rem;">${f.label}</span>
                                        ${f.stable 
                                            ? '<span style="font-size:0.75rem;color:#4CAF50;font-weight:600;">âœ… ê¸°ë³¸</span>'
                                            : `<label style="position:relative;display:inline-block;width:48px;height:26px;">
                                                <input type="checkbox" ${enabled?'checked':''} onchange="setFeatureFlag('${f.key}',this.checked)" style="opacity:0;width:0;height:0;">
                                                <span style="position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:${enabled?'#4CAF50':'#ccc'};border-radius:13px;transition:0.3s;"></span>
                                                <span style="position:absolute;content:'';height:20px;width:20px;left:${enabled?'24px':'3px'};bottom:3px;background:white;border-radius:50%;transition:0.3s;"></span>
                                              </label>`
                                        }`;
                                    container.appendChild(div);
                                });
                            }
                            
                            // Render when tab is shown
                            const observer = new MutationObserver(() => {
                                const tab = document.getElementById('admin-tab-features');
                                if (tab && tab.style.display !== 'none') renderFlags();
                            });
                            const tab = document.getElementById('admin-tab-features');
                            if (tab) observer.observe(tab, { attributes: true, attributeFilter: ['style'] });
                            setTimeout(renderFlags, 2000);
                        })();
                        </script>
                    </div>
                </div>

            </div>
        
            </div>
        </main>
    </div>

    <!-- Toast -->
    <div id="toast-container" style="position:fixed;top:20px;right:20px;z-index:99999;display:flex;flex-direction:column;gap:8px;pointer-events:none;"></div>
    <div id="loading-overlay" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);z-index:99998;align-items:center;justify-content:center;">
        <div style="background:white;padding:2rem;border-radius:12px;text-align:center;">
            <div style="width:40px;height:40px;border:4px solid #ddd;border-top:4px solid #0066cc;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 1rem;"></div>
            <p id="loading-text">ì²˜ë¦¬ ì¤‘...</p>
        </div>
    </div>
    <div id="confirm-modal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:99997;align-items:center;justify-content:center;padding:1rem;">
        <div style="background:white;padding:1.5rem;border-radius:12px;max-width:400px;width:100%;">
            <h3 id="confirm-title"></h3>
            <p id="confirm-message" style="color:#666;margin:0.8rem 0 1.2rem;white-space:pre-line;"></p>
            <div style="display:flex;gap:0.5rem;">
                <button id="confirm-cancel" onclick="closeConfirmModal(false)" style="flex:1;padding:0.7rem;border:1px solid #ddd;border-radius:8px;cursor:pointer;background:white;">ì·¨ì†Œ</button>
                <button id="confirm-ok" onclick="closeConfirmModal(true)" style="flex:1;padding:0.7rem;border:none;border-radius:8px;cursor:pointer;background:#0066cc;color:white;font-weight:700;">í™•ì¸</button>
            </div>
        </div>
    </div>
    <style>
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes slideIn { from { transform: translateX(100%); opacity:0; } to { transform: translateX(0); opacity:1; } }
        @keyframes fadeOut { from { opacity:1; } to { opacity:0; transform:translateY(-10px); } }
        .toast { pointer-events:auto; padding:0.8rem 1.2rem; border-radius:8px; color:white; font-size:0.9rem; box-shadow:0 4px 12px rgba(0,0,0,0.15); animation: slideIn 0.3s ease; max-width:350px; }
        .toast.success { background:#4CAF50; } .toast.error { background:#f44336; } .toast.info { background:#2196F3; } .toast.warning { background:#ff9800; }
        .toast.fadeout { animation: fadeOut 0.3s ease forwards; }
    </style>
    <script>
    function showToast(msg, type='info', dur=3000) { const c=document.getElementById('toast-container'); const t=document.createElement('div'); t.className='toast '+type; t.textContent=msg; c.appendChild(t); setTimeout(()=>{t.classList.add('fadeout'); setTimeout(()=>t.remove(),300);}, dur); }
    function showLoading(t='ì²˜ë¦¬ ì¤‘...') { document.getElementById('loading-text').textContent=t; document.getElementById('loading-overlay').style.display='flex'; }
    function hideLoading() { document.getElementById('loading-overlay').style.display='none'; }
    let _confirmResolve=null;
    function showConfirmModal(title, message) { return new Promise(r=>{_confirmResolve=r; document.getElementById('confirm-title').textContent=title; document.getElementById('confirm-message').textContent=message; document.getElementById('confirm-modal').style.display='flex';}); }
    function closeConfirmModal(result) { document.getElementById('confirm-modal').style.display='none'; if(_confirmResolve){_confirmResolve(result);_confirmResolve=null;} }
    function showPromptModal(title, message, defaultValue) {
        return new Promise(resolve => {
            const o = document.createElement('div');
            o.style.cssText='position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:99997;display:flex;align-items:center;justify-content:center;padding:1rem;';
            o.innerHTML=`<div style="background:white;padding:1.5rem;border-radius:12px;max-width:400px;width:100%;"><h3>${title}</h3><p style="color:#666;margin:0.5rem 0;white-space:pre-line;font-size:0.9rem;">${message}</p><input type="text" id="prompt-input" value="${defaultValue||''}" style="width:100%;padding:0.7rem;border:1px solid #ddd;border-radius:8px;font-size:1rem;box-sizing:border-box;margin:0.5rem 0;"><div style="display:flex;gap:0.5rem;"><button id="p-cancel" style="flex:1;padding:0.7rem;border:1px solid #ddd;border-radius:8px;cursor:pointer;background:white;">ì·¨ì†Œ</button><button id="p-ok" style="flex:1;padding:0.7rem;border:none;border-radius:8px;cursor:pointer;background:#1a1a2e;color:white;font-weight:700;">í™•ì¸</button></div></div>`;
            document.body.appendChild(o);
            const i=o.querySelector('#prompt-input'); i.focus(); i.select();
            i.onkeydown=e=>{if(e.key==='Enter'){o.remove();resolve(i.value);}if(e.key==='Escape'){o.remove();resolve(null);}};
            o.querySelector('#p-cancel').onclick=()=>{o.remove();resolve(null);};
            o.querySelector('#p-ok').onclick=()=>{o.remove();resolve(i.value);};
        });
    }
    </script>
    <script src="js/i18n.js?v=21.2"></script>
    <script src="js/config.js?v=21.2"></script>
    <script src="js/offchain.js?v=21.2"></script>
    <script src="js/ai-assistant.js?v=21.2"></script>
    <script src="js/ai-social.js?v=1.0"></script>
    <script src="js/beauty-manager.js?v=1.0"></script>
    <script>
    async function aiSocialPostAll() {
        const el = document.getElementById('ai-social-result');
        el.textContent = 'â³ 5ëª… í¬ìŠ¤íŒ… ìƒì„± ì¤‘... (ê° ìºë¦­í„° 5~10ì´ˆ ì†Œìš”)';
        try {
            try { await AI_SOCIAL.init(); } catch(e) { console.warn('init skip:', e); }
            const results = await AI_SOCIAL.autoPostAll();
            el.innerHTML = results.map(r => r.error ? `âŒ ${r.character}: ${r.error}` : `âœ… ${r.character}: ${r.text}...`).join('<br>');
        } catch (e) { el.textContent = 'âŒ ì˜¤ë¥˜: ' + e.message + '\n\n' + e.stack; }
    }
    async function aiSocialPostOne(key) {
        const el = document.getElementById('ai-social-result');
        el.textContent = 'â³ í¬ìŠ¤íŒ… ìƒì„± ì¤‘...';
        try {
            await AI_SOCIAL.init();
            const result = await AI_SOCIAL.autoPostOne(key);
            el.textContent = result ? `âœ… ${result.character}: ${result.text.substring(0, 80)}...` : 'âŒ ìƒì„± ì‹¤íŒ¨';
        } catch (e) { el.textContent = 'âŒ ì˜¤ë¥˜: ' + e.message; }
    }
    </script>
    <script src="js/admin.js?v=21.2"></script>
    <script src="js/seed-data.js?v=1.0"></script>
    <script>
    // showToast polyfill for admin.html
    if (typeof showToast === 'undefined') {
        function showToast(msg, type, dur) {
            const d = document.createElement('div');
            d.textContent = msg;
            d.style.cssText = 'position:fixed;bottom:2rem;left:50%;transform:translateX(-50%);padding:0.8rem 1.5rem;border-radius:8px;z-index:99999;color:#fff;font-size:0.9rem;background:' + (type==='error'?'#c0392b':type==='warning'?'#e67e22':'#2ecc71');
            document.body.appendChild(d);
            setTimeout(() => d.remove(), dur || 3000);
        }
    }
    </script>
    <script>
    // Admin page auth - redirect if not admin
    let web3;
    try { web3 = new Web3('https://polygon-rpc.com'); } catch(e) { web3 = new Web3('https://rpc-mainnet.matic.quiknode.pro'); }
    
    auth.onAuthStateChanged(async (user) => {
        if (!user) { location.href = 'index.html'; return; }
        currentUser = user;
        document.getElementById('admin-user-email').textContent = user.email;
        await loadUserLevel();
        if (typeof loadTokenRegistry === 'function') await loadTokenRegistry();
        if (typeof loadExchangeRate === 'function') await loadExchangeRate();
        
        if (currentUserLevel < 1) {
            document.getElementById('admin-loading').innerHTML = '<h2>â›” ê¶Œí•œ ì—†ìŒ</h2><p>ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.</p><a href="index.html">â† ë©”ì¸ìœ¼ë¡œ</a>';
            return;
        }
        document.getElementById('admin-loading').style.display = 'none';
        document.getElementById('admin-content').style.display = 'block';
        document.getElementById('admin-not-authorized').style.display = 'none';
        document.getElementById('admin-panel').style.display = 'block';
        
        // Build sidebar nav
        const nav = document.getElementById('admin-sidebar-nav');
        if (typeof ADMIN_TAB_CONFIG !== 'undefined') {
            ADMIN_TAB_CONFIG.filter(t => hasLevel(t.minLevel)).forEach(t => {
                const a = document.createElement('a');
                a.className = 'nav-link';
                a.href = '#';
                a.textContent = t.icon + ' ' + t.label;
                a.onclick = (e) => { e.preventDefault(); switchAdminTab(t.id); nav.querySelectorAll('.nav-link').forEach(n=>n.classList.remove('active')); a.classList.add('active'); };
                nav.appendChild(a);
            });
        }
        
        initAdminPage();
    });
    
    // Lucide Icons ì´ˆê¸°í™”
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
    
    window.initLucideIcons = function() {
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        }
    };
    </script>
</body>
</html>
